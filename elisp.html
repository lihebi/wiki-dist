<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-11-20 Mon 10:50 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Emacs Lisp</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Hebi Li" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="assets/hebi.css" /><link rel="stylesheet" type="text/css" href="assets/test.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Emacs Lisp</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org411aa2b">1. Evaluation</a>
<ul>
<li><a href="#orge2000dc">1.1. quoting</a></li>
<li><a href="#org3459cc7">1.2. backquoting</a></li>
</ul>
</li>
<li><a href="#org1bfb751">2. Basic</a>
<ul>
<li><a href="#org8b45c56">2.1. Interactive</a></li>
<li><a href="#orgeeb1905">2.2. Symbol</a>
<ul>
<li><a href="#org9ac7adc">2.2.1. property list</a></li>
<li><a href="#org563f2f5">2.2.2. Variable</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgc64af20">3. Regular Expression</a>
<ul>
<li><a href="#org367d770">3.1. syntax</a>
<ul>
<li><a href="#org49b0858">3.1.1. basics</a></li>
<li><a href="#orgff0dcff">3.1.2. Character classes</a></li>
<li><a href="#org05e09b6">3.1.3. Backslash</a></li>
<li><a href="#orgf8507ef">3.1.4. Syntax code</a></li>
</ul>
</li>
<li><a href="#org5391d35">3.2. constructing</a></li>
<li><a href="#org7d78bcc">3.3. Searching</a></li>
</ul>
</li>
<li><a href="#orgf74800d">4. Type</a>
<ul>
<li><a href="#org8ef09b0">4.1. number</a></li>
<li><a href="#org3c03d33">4.2. string</a></li>
<li><a href="#org87d5959">4.3. cons cell</a></li>
<li><a href="#org32dcdc5">4.4. list</a>
<ul>
<li><a href="#orgfc8489e">4.4.1. construct</a></li>
<li><a href="#org87e3d1c">4.4.2. access</a></li>
<li><a href="#orgf6dcdf7">4.4.3. modify</a></li>
</ul>
</li>
<li><a href="#org26570ae">4.5. set</a></li>
<li><a href="#org407803f">4.6. association list</a></li>
<li><a href="#orgbe81e55">4.7. property list</a></li>
<li><a href="#org3aeddec">4.8. sequence</a></li>
<li><a href="#org2049a79">4.9. array</a>
<ul>
<li><a href="#org2918619">4.9.1. constructing</a></li>
<li><a href="#orgdeeb2d5">4.9.2. accessing</a></li>
</ul>
</li>
<li><a href="#org01200e5">4.10. hash table</a></li>
</ul>
</li>
<li><a href="#orge3d63a1">5. Function</a>
<ul>
<li><a href="#org3bba5ab">5.1. define</a></li>
<li><a href="#orgddd6e99">5.2. Calling</a></li>
<li><a href="#org41846fc">5.3. Mapping family</a></li>
<li><a href="#orgac00352">5.4. Anonymous functions</a></li>
<li><a href="#org7e2fda1">5.5. Macro</a></li>
</ul>
</li>
<li><a href="#org576d8ee">6. Control Structure</a>
<ul>
<li><a href="#org244793e">6.1. Sequential</a></li>
<li><a href="#org6cd5e0e">6.2. Conditional</a>
<ul>
<li><a href="#org2225220">6.2.1. logical computation</a></li>
</ul>
</li>
<li><a href="#org68920f6">6.3. Loop</a></li>
</ul>
</li>
<li><a href="#orge3bc3c3">7. Packages</a>
<ul>
<li><a href="#org5eb4abc">7.1. Dash.el</a></li>
<li><a href="#org4932ffa">7.2. s.el</a></li>
<li><a href="#org165ca6b">7.3. cl-lib.el loop</a>
<ul>
<li><a href="#org111c34d">7.3.1. general loop form</a></li>
<li><a href="#orgc181117">7.3.2. for clauses</a></li>
<li><a href="#org54c2240">7.3.3. iteration clauses</a></li>
<li><a href="#org6665599">7.3.4. accumulation clauses</a></li>
<li><a href="#org30602d7">7.3.5. Other clauses</a></li>
</ul>
</li>
<li><a href="#orge31643b">7.4. cl-lib other</a></li>
</ul>
</li>
<li><a href="#org91c74fd">8. Debugging</a>
<ul>
<li><a href="#org6858aec">8.1. lisp debugger</a></li>
<li><a href="#orgeaa1d68">8.2. Edebug</a>
<ul>
<li><a href="#org4e5f675">8.2.1. breakpoints</a></li>
<li><a href="#orgeeebea9">8.2.2. Moving of point</a></li>
<li><a href="#org3a917a3">8.2.3. executions</a></li>
<li><a href="#org07b9a04">8.2.4. evaluation</a></li>
<li><a href="#orge6ff969">8.2.5. other commands</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2a1f67f">9. Unit Testing</a>
<ul>
<li><a href="#org175a563">9.1. Write test</a></li>
<li><a href="#org4f17b23">9.2. Run test</a></li>
</ul>
</li>
<li><a href="#orgdf696c4">10. Some random code snippets</a>
<ul>
<li>
<ul>
<li><a href="#org561cf48">10.0.1. Url retrieval</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<blockquote>
<p>
The names CAR and CDR derive from the history of Lisp.  The original
Lisp implementation ran on an IBM 704 computer which divided words into
two parts, called the “address” part and the “decrement”; CAR was an
instruction to extract the contents of the address part of a register,
and CDR an instruction to extract the contents of the decrement.  By
contrast, “cons cells” are named for the function ‘cons’ that creates
them, which in turn was named for its purpose, the construction of
cells.
</p>
</blockquote>
<div id="outline-container-org411aa2b" class="outline-2">
<h2 id="org411aa2b"><span class="section-number-2">1</span> Evaluation</h2>
<div class="outline-text-2" id="text-1">
<p>
The read and evaluate is <i>seperate</i>. For example, <code>(1 2 3)</code> is a list, and can be read by lisp interpreter as an object: a list.
But try to evalute it in emacs results in error. It is not because emacs cannot read it.
It can, but it tries to evaluate it using a list form, which checks the car of list and treat it as a function. Of course '1' is not a function.
</p>

<p>
There's a form called <i>self-evaluating form</i>. It evaluate to itself.
For example, the number, the string, evaluates to itself.
</p>
</div>

<div id="outline-container-orge2000dc" class="outline-3">
<h3 id="orge2000dc"><span class="section-number-3">1.1</span> quoting</h3>
<div class="outline-text-3" id="text-1-1">
<p>
From the elisp info page:
</p>
<blockquote>
<p>
The special form ‘quote’ returns its single argument, as written,
without evaluating it.  This provides a way to include constant symbols
and lists, which are not self-evaluating objects, in a program.  (It is
not necessary to quote self-evaluating objects such as numbers, strings,
and vectors.)
</p>
</blockquote>

<p>
The expression <code>\'print</code> means read it without evaluation. So the following expression makes sense:
</p>
<div class="org-src-container">
<pre class="src src-elisp">(eval (list 'prin1 '1))
</pre>
</div>

<p>
Note that <code>(quote x)</code> and <code>'x</code> are equivalent.
</p>
</div>
</div>

<div id="outline-container-org3459cc7" class="outline-3">
<h3 id="org3459cc7"><span class="section-number-3">1.2</span> backquoting</h3>
<div class="outline-text-3" id="text-1-2">
<p>
It is identical to quoting except that it allows to evaluate part of the object.
The special marker <code>,</code> can be used:
</p>

<div class="org-src-container">
<pre class="src src-elisp">`(a list of ,(+ 2 3) elements)
<span style="color: #b22222;">; </span><span style="color: #b22222;">-&gt; (a list of 5 elements)</span>
</pre>
</div>

<p>
If the partial evaluation returns a list, but you want to <b>splice</b> it with some other elements into a list, you can do it neatly with <code>,@</code>:
</p>

<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">setq</span> some-list '(2 3))
`(1 ,@some-list 4 ,@some-list)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">-&gt; (1 2 3 4 2 3)</span>
</pre>
</div>

<p>
Without this feature, you have to write some hard to understand code:
</p>
<div class="org-src-container">
<pre class="src src-elisp">(cons 1 (append some-list '(4) some-list))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">-&gt; (1 2 3 4 2 3)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org1bfb751" class="outline-2">
<h2 id="org1bfb751"><span class="section-number-2">2</span> Basic</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org8b45c56" class="outline-3">
<h3 id="org8b45c56"><span class="section-number-3">2.1</span> Interactive</h3>
<div class="outline-text-3" id="text-2-1">
<dl class="org-dl">
<dt><code>print</code></dt><dd>print the object in quotes, with a newline before and after it</dd>
<dt><code>prin1</code></dt><dd>print the object in quotes without newlines</dd>
<dt><code>princ</code></dt><dd>print the object without quotes, without newlines</dd>
<dt>(no term)</dt><dd><code>message</code></dd>
</dl>
</div>
</div>

<div id="outline-container-orgeeb1905" class="outline-3">
<h3 id="orgeeb1905"><span class="section-number-3">2.2</span> Symbol</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>defvar</li>
<li>defun</li>
<li>defmacro</li>
</ul>

<p>
A symbol can <i>not</i> be both a function and macro, but it can be a variable and a function at the same time.
</p>
</div>

<div id="outline-container-org9ac7adc" class="outline-4">
<h4 id="org9ac7adc"><span class="section-number-4">2.2.1</span> property list</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
A symbol can have a property list &#x2026;
</p>
<dl class="org-dl">
<dt><code>get symbol property</code></dt><dd></dd>

<dt><code>put symbol property value</code></dt><dd></dd>

<dt><code>symbol-plist symbol</code></dt><dd>return the p-list</dd>
<dt><code>setplist symbol plist</code></dt><dd></dd>
</dl>
</div>
</div>
<div id="outline-container-org563f2f5" class="outline-4">
<h4 id="org563f2f5"><span class="section-number-4">2.2.2</span> Variable</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
Dynamic binding: in the defun, we can refer to free variable. When calling the defun in different environment, it will get the variable from them.
This is used by default.
</p>

<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">x</span> -99)
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">getx</span> () x)
(<span style="color: #a020f0;">let</span> ((x 1)) (getx)) <span style="color: #b22222;">; </span><span style="color: #b22222;">-&gt; 1</span>
(getx) <span style="color: #b22222;">; </span><span style="color: #b22222;">-&gt; -99</span>
</pre>
</div>

<p>
Lexical is also introduced as optional feature.
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-orgc64af20" class="outline-2">
<h2 id="orgc64af20"><span class="section-number-2">3</span> Regular Expression</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org367d770" class="outline-3">
<h3 id="org367d770"><span class="section-number-3">3.1</span> syntax</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org49b0858" class="outline-4">
<h4 id="org49b0858"><span class="section-number-4">3.1.1</span> basics</h4>
<div class="outline-text-4" id="text-3-1-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>

<colgroup>
<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">symbol</th>
<th scope="col" class="org-left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>.</code></td>
<td class="org-left">match anything except a newline</td>
</tr>

<tr>
<td class="org-left"><code>*</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>+</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>?</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>*?</code>, <code>+?</code>, <code>??</code></td>
<td class="org-left">non-greedy, match the smallest part</td>
</tr>

<tr>
<td class="org-left"><code>[]</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>[^]</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>^</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>$</code></td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgff0dcff" class="outline-4">
<h4 id="orgff0dcff"><span class="section-number-4">3.1.2</span> Character classes</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
Use the double <code>[[]]</code> form. E.g. <code>[[:ascii:]]</code>, and also the negative writes <code>[^[:ascii:]]</code>.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>

<colgroup>
<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">symbol</th>
<th scope="col" class="org-left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>ascii</code></td>
<td class="org-left">0-127</td>
</tr>

<tr>
<td class="org-left"><code>alnum</code></td>
<td class="org-left">letter or digit</td>
</tr>

<tr>
<td class="org-left"><code>alpha</code></td>
<td class="org-left">letter</td>
</tr>

<tr>
<td class="org-left"><code>blank</code></td>
<td class="org-left">space and tab</td>
</tr>

<tr>
<td class="org-left"><code>cntrl</code></td>
<td class="org-left">ASCII control char</td>
</tr>

<tr>
<td class="org-left"><code>digit</code></td>
<td class="org-left">0-9</td>
</tr>

<tr>
<td class="org-left"><code>lower</code></td>
<td class="org-left">lower-case</td>
</tr>

<tr>
<td class="org-left"><code>upper</code></td>
<td class="org-left">upper-case</td>
</tr>

<tr>
<td class="org-left"><code>punct</code></td>
<td class="org-left">punctuation</td>
</tr>

<tr>
<td class="org-left"><code>space</code></td>
<td class="org-left">whitespace</td>
</tr>

<tr>
<td class="org-left"><code>word</code></td>
<td class="org-left"><code>\w</code></td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org05e09b6" class="outline-4">
<h4 id="org05e09b6"><span class="section-number-4">3.1.3</span> Backslash</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
Backslash is also used in elisp read syntax. So when you want one <code>\</code> in the string, you need to write double.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>

<colgroup>
<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">symbol</th>
<th scope="col" class="org-left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>\1</code> (pipe)</td>
<td class="org-left">either one of two expressions. Can be used in capturing group</td>
</tr>

<tr>
<td class="org-left"><code>\{\}</code></td>
<td class="org-left"><code>{}</code> counter part</td>
</tr>

<tr>
<td class="org-left"><code>\(\)</code></td>
<td class="org-left">capturing group</td>
</tr>

<tr>
<td class="org-left"><code>\(?:\)</code></td>
<td class="org-left">non-capturing group</td>
</tr>

<tr>
<td class="org-left"><code>\(?NUM:\)</code></td>
<td class="org-left">numbered capturing group.. If conflict numbers, last one will win</td>
</tr>

<tr>
<td class="org-left"><code>\DIGIT</code></td>
<td class="org-left">back reference</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>\w</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>\W</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>\b</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>\B</code></td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgf8507ef" class="outline-4">
<h4 id="orgf8507ef"><span class="section-number-4">3.1.4</span> Syntax code</h4>
<div class="outline-text-4" id="text-3-1-4">
<p>
<code>\sCODE</code> can be used to refer to any character "whose syntax is CODE".
<code>\SCODE</code> is the negative form.
See the "Syntax Class Table" chapter of elisp manual for details.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>

<colgroup>
<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">symbol</th>
<th scope="col" class="org-left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>\s-</code></td>
<td class="org-left">whitespace</td>
</tr>

<tr>
<td class="org-left"><code>\s[space]</code></td>
<td class="org-left">whitespace</td>
</tr>

<tr>
<td class="org-left"><code>\sw</code></td>
<td class="org-left"><code>\w</code></td>
</tr>

<tr>
<td class="org-left"><code>\s.</code></td>
<td class="org-left">punctuation</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org5391d35" class="outline-3">
<h3 id="org5391d35"><span class="section-number-3">3.2</span> constructing</h3>
<div class="outline-text-3" id="text-3-2">
<dl class="org-dl">
<dt><code>regexp-quote string</code></dt><dd>return a regular expression, whose only exact match is string.
<code>(regexp-quote "^The cat$")</code> returns <code>"\\^The cat\\$"</code>. It is useful for example:</dd>
</dl>

<div class="org-src-container">
<pre class="src src-elisp">(re-search-forward
 (concat <span style="color: #8b2252;">"\\s-"</span> (regexp-quote string) <span style="color: #8b2252;">"\\s-"</span>))
</pre>
</div>

<dl class="org-dl">
<dt><code>regexp-opt strings</code></dt><dd>return an <i>efficient</i> regular expression, that will matches any of the strings supplied.</dd>
</dl>
</div>
</div>

<div id="outline-container-org7d78bcc" class="outline-3">
<h3 id="org7d78bcc"><span class="section-number-3">3.3</span> Searching</h3>
<div class="outline-text-3" id="text-3-3">
<dl class="org-dl">
<dt><code>re-search-forward regexp</code></dt><dd></dd>

<dt><code>re-search-backward regexp</code></dt><dd></dd>

<dt><code>string-match regexp string</code></dt><dd>returns the index of the start of the first match. It will set the <i>Match Data</i></dd>
<dt><code>string-match-p regexp string</code></dt><dd>same as <code>string-match</code> except it does not modify <i>Match Data</i>.</dd>
</dl>

<p>
accessing the match data
</p>
<dl class="org-dl">
<dt><code>match-string count</code></dt><dd>count is the index, with 0 to the the entire match</dd>
<dt><code>match-beginning count</code></dt><dd>return the beginning index of the match</dd>
<dt><code>match-end count</code></dt><dd></dd>
</dl>

<p>
replacing
</p>
<dl class="org-dl">
<dt><code>replace-regexp-in-string regexp rep string</code></dt><dd>return a modified copy. replace all of matches.</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-orgf74800d" class="outline-2">
<h2 id="orgf74800d"><span class="section-number-2">4</span> Type</h2>
<div class="outline-text-2" id="text-4">
<dl class="org-dl">
<dt><code>(eq OBJ1 OBJ2)</code></dt><dd>Return t if the two args are the same Lisp object. It is faster than <code>equal</code>.</dd>
<dt><code>(equal O1 O2)</code></dt><dd>Return t if two Lisp objects have similar structure and contents. So it does <i>comparison only</i>.</dd>
<dt><code>(=)</code></dt><dd>true if all arguments are equal. Only works for numbers</dd>
<dt><code>(string=)</code></dt><dd>compare two strings</dd>
</dl>
</div>
<div id="outline-container-org8ef09b0" class="outline-3">
<h3 id="org8ef09b0"><span class="section-number-3">4.1</span> number</h3>
<div class="outline-text-3" id="text-4-1">
<dl class="org-dl">
<dt><code>(expt 2 8)</code></dt><dd>2<sup>8</sup></dd>
</dl>
</div>
</div>

<div id="outline-container-org3c03d33" class="outline-3">
<h3 id="org3c03d33"><span class="section-number-3">4.2</span> string</h3>
<div class="outline-text-3" id="text-4-2">
<dl class="org-dl">
<dt><code>make-string count character</code></dt><dd>make string by duplicating characters</dd>
<dt><code>substring string start &amp;optional end</code></dt><dd>substring</dd>
<dt><code>concat &amp;rest sequences</code></dt><dd></dd>

<dt><code>split-string string &amp;optional separators</code></dt><dd><code>split-string-default-separators</code> is <code>"[ \f\t\n\r\v]+"</code></dd>
</dl>

<p>
conversion:
</p>
<dl class="org-dl">
<dt><code>number-to-string number</code></dt><dd></dd>

<dt><code>string-to-number string</code></dt><dd></dd>

<dt><code>char-to-string character</code></dt><dd></dd>

<dt><code>string-to-char string</code></dt><dd>returns the first character in string</dd>
</dl>

<p>
case:
</p>
<dl class="org-dl">
<dt><code>downcase string-or-char</code></dt><dd></dd>

<dt><code>upcase string-or-char</code></dt><dd></dd>

<dt><code>capitalize string-to-char</code></dt><dd></dd>
</dl>
</div>
</div>

<div id="outline-container-org87d5959" class="outline-3">
<h3 id="org87d5959"><span class="section-number-3">4.3</span> cons cell</h3>
<div class="outline-text-3" id="text-4-3">
<p>
This is a pair of slots, each of them can hold anything.
A list is a list of cons cells, in which each cdr is the "address" next list.
</p>

<p>
A <i>dotted pair notation</i> is a more general syntax of a cons cell.
It is written as <code>(A . B)</code>.
It is more general because the cdr can also hold anything.
As an example, <code>(1 2 3)</code> is the same as <code>(1 . (2 . (3 . nil)))</code>.
</p>
</div>
</div>

<div id="outline-container-org32dcdc5" class="outline-3">
<h3 id="org32dcdc5"><span class="section-number-3">4.4</span> list</h3>
<div class="outline-text-3" id="text-4-4">
<p>
If the CDR of a list’s last cons cell is some value other than ‘nil’,
we call the structure a "dotted list",
since its printed representation would use dotted pair notation.
</p>
</div>

<div id="outline-container-orgfc8489e" class="outline-4">
<h4 id="orgfc8489e"><span class="section-number-4">4.4.1</span> construct</h4>
<div class="outline-text-4" id="text-4-4-1">
<dl class="org-dl">
<dt><code>cons obj1 obj2</code></dt><dd>if obj2 is a list, this is called "cons obj1 onto the list"</dd>
<dt><code>list &amp;rest OBJECTS</code></dt><dd>create a list</dd>
<dt><code>make-list length obj</code></dt><dd>make a list of length, in which each cell holds the <i>same</i> object (<code>eq</code>)</dd>
<dt><code>append &amp;rest SEQUENCES</code></dt><dd>concatenate some lists into one list.
The last one is usually a list, all arguments except the last one are copied.
If want to force copy everything, add a <code>nil</code> as the last of append.</dd>
<dt><code>reverse list</code></dt><dd>reverse the list by copying</dd>
<dt><code>number-sequence from to</code></dt><dd>the list of <code>[from,to]</code>, inclusive</dd>
</dl>
</div>
</div>

<div id="outline-container-org87e3d1c" class="outline-4">
<h4 id="org87e3d1c"><span class="section-number-4">4.4.2</span> access</h4>
<div class="outline-text-4" id="text-4-4-2">
<dl class="org-dl">
<dt><code>car</code></dt><dd></dd>

<dt><code>cdr</code></dt><dd></dd>

<dt><code>car-safe</code></dt><dd></dd>

<dt><code>cdr-safe</code></dt><dd></dd>

<dt><code>pop</code></dt><dd>return the cdr of the list, and also remove it from the list</dd>
<dt><code>nth n list</code></dt><dd>get the nth element, starting from 0</dd>
<dt><code>nthcdr n list</code></dt><dd>execute cdr n times</dd>
<dt><code>last list</code></dt><dd></dd>

<dt><code>length</code></dt><dd></dd>


<dt><code>caar</code></dt><dd>car car, 11</dd>
<dt><code>card</code></dt><dd>car cdr, 12</dd>
<dt><code>cdar</code></dt><dd>cdr car, 21</dd>
<dt><code>cddr</code></dt><dd>cdr cdr, 22</dd>
</dl>
</div>
</div>

<div id="outline-container-orgf6dcdf7" class="outline-4">
<h4 id="orgf6dcdf7"><span class="section-number-4">4.4.3</span> modify</h4>
<div class="outline-text-4" id="text-4-4-3">
<p>
<i>destructive</i> means the cdr of the cons cells are modified.
</p>

<dl class="org-dl">
<dt><code>push element listname</code></dt><dd>like cons it onto the list, but save it as listname, i.e. modify the variable</dd>
<dt><code>add-to-list symbol element</code></dt><dd>cons element onto the list if it is not there.
So the following is equivalent: <code>(add-to-list 'var value)</code> and <code>(or (member value var) (setq var (cons value var)))</code></dd>
<dt><code>setcar cons obj</code></dt><dd></dd>

<dt><code>setcdr cons obj</code></dt><dd></dd>

<dt><code>sort list predicate</code></dt><dd>this rearrange the cdrs of the list, so, <i>destructive</i>!
Examples:</dd>
</dl>
<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">setq</span> nums '(1 3 2 6 5 4 0))
(sort nums '&lt;) <span style="color: #b22222;">; </span><span style="color: #b22222;">accending</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org26570ae" class="outline-3">
<h3 id="org26570ae"><span class="section-number-3">4.5</span> set</h3>
<div class="outline-text-3" id="text-4-5">
<p>
We use list as set, by ignoring the order &#x2026;
<code>append</code> to combine two set, then <code>delete-dups</code> to remove duplication &#x2026;
</p>

<dl class="org-dl">
<dt><code>memq obj list</code></dt><dd>whether obj is a member of list, using <code>eq</code></dd>
<dt><code>delq obj list</code></dt><dd>destructively remove all elements <code>eq</code> to obj.</dd>
<dt><code>rmq obj list</code></dt><dd>return a copy of list with all obj removed</dd>
<dt><code>member</code></dt><dd><code>equal</code> counter-part</dd>
<dt><code>member-ignore-case</code></dt><dd>for string</dd>
<dt><code>delete</code></dt><dd><code>equal</code> counter-part</dd>
<dt><code>remove</code></dt><dd><code>equal</code> counter-part</dd>
<dt><code>delete-dups</code></dt><dd>use <code>equal</code></dd>
</dl>
</div>
</div>
<div id="outline-container-org407803f" class="outline-3">
<h3 id="org407803f"><span class="section-number-3">4.6</span> association list</h3>
<div class="outline-text-3" id="text-4-6">
<p>
This is a special list, each element is a key-value pair.
</p>
<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">setq</span> alist-of-colors
  '((rose . red) (lily . white) (buttercup . yellow)))
</pre>
</div>

<dl class="org-dl">
<dt><code>assoc KEY aLIST</code></dt><dd>the first element of LIST whose car <code>equal</code> KEY.</dd>
<dt><code>rassoc value alist</code></dt><dd>compare the cdrs instead of cars</dd>
<dt><code>assq KEY aLIST</code></dt><dd>the first element of LIST whose car <code>eq</code> KEY.</dd>
<dt><code>rassq</code></dt><dd><code>eq</code> counter-part</dd>

<dt><code>copy-alist alist</code></dt><dd>two-level deep copy</dd>
<dt><code>assq-delete-all key alist</code></dt><dd>delete all elements whose car <code>eq</code> key</dd>
<dt><code>rassq-delete-all value alist</code></dt><dd>cdr counter-part</dd>
<dt><code>(assoc-string KEY LIST &amp;optional CASE-FOLD)</code></dt><dd><code>assoc</code> for string. if <code>CASE-FOLD</code> is <code>non-nil</code>, case is ignored.</dd>
</dl>
</div>
</div>

<div id="outline-container-orgbe81e55" class="outline-3">
<h3 id="orgbe81e55"><span class="section-number-3">4.7</span> property list</h3>
<div class="outline-text-3" id="text-4-7">
<p>
It is a flat list. The odd elements are property name, and the even elements are values.
</p>
<div class="org-src-container">
<pre class="src src-elisp">(pine cones numbers (1 2 3) color <span style="color: #8b2252;">"blue"</span>)
</pre>
</div>

<p>
It can be structured as
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">property</th>
<th scope="col" class="org-left">value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">pine</td>
<td class="org-left">cones</td>
</tr>

<tr>
<td class="org-left">numbers</td>
<td class="org-left">(1 2 3)</td>
</tr>

<tr>
<td class="org-left">color</td>
<td class="org-left">"blue"</td>
</tr>
</tbody>
</table>

<p>
The property names <i>must</i> be unique.
The order of the "pairs" does not matter.
</p>

<dl class="org-dl">
<dt><code>plist-get plist property</code></dt><dd></dd>

<dt><code>plist-put plist property value</code></dt><dd></dd>

<dt><code>lax-plist-get</code></dt><dd><code>equal</code> counterpart</dd>
<dt><code>lax-plist-put</code></dt><dd><code>equal</code> counterpart</dd>
<dt><code>plist-member plist property</code></dt><dd>this is useful because it can distinguish the missing property and the property with value "nil"</dd>
</dl>
</div>
</div>

<div id="outline-container-org3aeddec" class="outline-3">
<h3 id="org3aeddec"><span class="section-number-3">4.8</span> sequence</h3>
<div class="outline-text-3" id="text-4-8">
<pre class="example">
 _____________________________________________
|                                             |
|          Sequence                           |
|  ______   ________________________________  |
| |      | |                                | |
| | List | |             Array              | |
| |      | |    ________       ________     | |
| |______| |   |        |     |        |    | |
|          |   | Vector |     | String |    | |
|          |   |________|     |________|    | |
|          |  ____________   _____________  | |
|          | |            | |             | | |
|          | | Char-table | | Bool-vector | | |
|          | |____________| |_____________| | |
|          |________________________________| |
|_____________________________________________|

</pre>

<dl class="org-dl">
<dt><code>length sequence</code></dt><dd></dd>

<dt><code>elt sequence index</code></dt><dd>returns the element of SEQUENCE at index</dd>
<dt><code>copy-sequence seq</code></dt><dd>the sequence is new, but the elements are not.</dd>
</dl>
</div>
</div>

<div id="outline-container-org2049a79" class="outline-3">
<h3 id="org2049a79"><span class="section-number-3">4.9</span> array</h3>
<div class="outline-text-3" id="text-4-9">
<p>
It is fixed length sequence.
</p>
</div>
<div id="outline-container-org2918619" class="outline-4">
<h4 id="org2918619"><span class="section-number-4">4.9.1</span> constructing</h4>
<div class="outline-text-4" id="text-4-9-1">
<dl class="org-dl">
<dt><code>make-vector length object</code></dt><dd>create vector</dd>
<dt><code>vector &amp;rest objects</code></dt><dd>create vector</dd>
</dl>
</div>
</div>
<div id="outline-container-orgdeeb2d5" class="outline-4">
<h4 id="orgdeeb2d5"><span class="section-number-4">4.9.2</span> accessing</h4>
<div class="outline-text-4" id="text-4-9-2">
<dl class="org-dl">
<dt><code>aref array index</code></dt><dd>getter</dd>
<dt><code>aset array index object</code></dt><dd>setter</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org01200e5" class="outline-3">
<h3 id="org01200e5"><span class="section-number-3">4.10</span> hash table</h3>
<div class="outline-text-3" id="text-4-10">
<p>
construct
</p>
<dl class="org-dl">
<dt><code>(make-hash-table)</code></dt><dd></dd>
</dl>

<p>
access
</p>
<dl class="org-dl">
<dt><code>gethash key table</code></dt><dd></dd>

<dt><code>puthash key value table</code></dt><dd></dd>

<dt><code>remhash key table</code></dt><dd>remove</dd>
<dt><code>clrhash table</code></dt><dd>remove all</dd>
<dt><code>maphash function table</code></dt><dd>call function once for each of the element in table. The function should accept two arguments: key and value</dd>
</dl>
<p>
other
</p>
<dl class="org-dl">
<dt><code>hash-table-count table</code></dt><dd>return number of entries</dd>
</dl>
</div>
</div>
</div>


<div id="outline-container-orge3d63a1" class="outline-2">
<h2 id="orge3d63a1"><span class="section-number-2">5</span> Function</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org3bba5ab" class="outline-3">
<h3 id="org3bba5ab"><span class="section-number-3">5.1</span> define</h3>
<div class="outline-text-3" id="text-5-1">
<dl class="org-dl">
<dt><code>defun name args body ...</code></dt><dd></dd>
</dl>
</div>
</div>

<div id="outline-container-orgddd6e99" class="outline-3">
<h3 id="orgddd6e99"><span class="section-number-3">5.2</span> Calling</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Usually put the function name as the car of the list will call it.
If you want to <b>compute which function to execute</b> at runtime, use <code>funcall</code>:
If you want to <b>compute the arguments</b> at runtime, use <code>apply</code>:
</p>

<dl class="org-dl">
<dt><code>funcall function &amp;rest arguments</code></dt><dd></dd>

<dt><code>apply function &amp;rest arguments</code></dt><dd>same as <code>funcall</code>, but the <i>last</i> of arguments is a list, and will be expanded into many arguments instead of a list.</dd>
</dl>
</div>
</div>

<div id="outline-container-org41846fc" class="outline-3">
<h3 id="org41846fc"><span class="section-number-3">5.3</span> Mapping family</h3>
<div class="outline-text-3" id="text-5-3">
<dl class="org-dl">
<dt><code>mapcar function sequence</code></dt><dd>execute function on each element of sequence, and return the list of results.</dd>
<dt><code>mapc function sequence</code></dt><dd>same as <code>mapcar</code> except it returns the <code>sequence</code>, with the intention to collect side effect.</dd>
<dt><code>mapconcat function sequence separator</code></dt><dd>execute function on elements of sequence. The results must be strings, and will be concatenated and returned.</dd>
</dl>
</div>
</div>

<div id="outline-container-orgac00352" class="outline-3">
<h3 id="orgac00352"><span class="section-number-3">5.4</span> Anonymous functions</h3>
<div class="outline-text-3" id="text-5-4">
<p>
It has three forms:
</p>
<dl class="org-dl">
<dt><code>lambda args body...</code></dt><dd></dd>

<dt><code>function function-object</code></dt><dd>returns the function without evaluating it. It is the "quote" for function</dd>
<dt><code>#'</code></dt><dd>this is the read syntax for the above <code>function</code> special form. You see, it is indeed the "quote" for the function.</dd>
</dl>
</div>
</div>

<div id="outline-container-org7e2fda1" class="outline-3">
<h3 id="org7e2fda1"><span class="section-number-3">5.5</span> Macro</h3>
<div class="outline-text-3" id="text-5-5">
<p>
Macro does not evaluate its arguments. It put the arguments <i>as is</i> and put them into the macro body to form an expression.
The expression is then evaluated for result.
</p>
<dl class="org-dl">
<dt><code>defmacro name args body...</code></dt><dd></dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org576d8ee" class="outline-2">
<h2 id="org576d8ee"><span class="section-number-2">6</span> Control Structure</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org244793e" class="outline-3">
<h3 id="org244793e"><span class="section-number-3">6.1</span> Sequential</h3>
<div class="outline-text-3" id="text-6-1">
<dl class="org-dl">
<dt><code>progn forms...</code></dt><dd>return the result of final form</dd>
<dt><code>prog1 form1 forms...</code></dt><dd>return the result of form1</dd>
<dt><code>prog2 form1 form2 forms...</code></dt><dd>return the result of form2</dd>
</dl>
</div>
</div>
<div id="outline-container-org6cd5e0e" class="outline-3">
<h3 id="org6cd5e0e"><span class="section-number-3">6.2</span> Conditional</h3>
<div class="outline-text-3" id="text-6-2">
<dl class="org-dl">
<dt><code>if condition then-form else-forms...</code></dt><dd></dd>

<dt><code>when condition then-forms...</code></dt><dd></dd>

<dt><code>unless condition forms...</code></dt><dd></dd>

<dt><code>cond clause...</code></dt><dd>the clause must be a list: <code>(condition body-forms...)</code>.
It is not exactly the "case" statement, because the condition is evaluted to true or false.
Any remaining forms are <i>ignored</i>.</dd>
<dt><code>pcase EXP BRANCH1 BRANCH2 BRANCH3...</code></dt><dd>this is more like the "case" statement. The EXP is first evaluted and compare with the car of each branches.
The branch must be of the form <code>(UPATTERN BODY-FORMS...)</code>.</dd>
</dl>
</div>

<div id="outline-container-org2225220" class="outline-4">
<h4 id="org2225220"><span class="section-number-4">6.2.1</span> logical computation</h4>
<div class="outline-text-4" id="text-6-2-1">
<ul class="org-ul">
<li><code>not</code></li>
<li><code>and</code></li>
<li><code>or</code></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org68920f6" class="outline-3">
<h3 id="org68920f6"><span class="section-number-3">6.3</span> Loop</h3>
<div class="outline-text-3" id="text-6-3">
<dl class="org-dl">
<dt><code>while condition forms...</code></dt><dd></dd>

<dt><code>dolist (var list [result]) body...</code></dt><dd>execute body for each element of list, with the bound of var to the current element and result for return.</dd>
<dt><code>dotimes (var count [result]) body...</code></dt><dd>execute body for each index of <code>[0,count)</code>, with var bound to the index, and result bound for return.</dd>
</dl>
</div>
</div>
</div>



<div id="outline-container-orge3bc3c3" class="outline-2">
<h2 id="orge3bc3c3"><span class="section-number-2">7</span> Packages</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org5eb4abc" class="outline-3">
<h3 id="org5eb4abc"><span class="section-number-3">7.1</span> Dash.el</h3>
<div class="outline-text-3" id="text-7-1">
<p>
<a href="https://github.com/magnars/dash.el">https://github.com/magnars/dash.el</a>
</p>

<p>
This is a collection of list libraries.
</p>

<ul class="org-ul">
<li><p>
<code>-map</code> takes a function to map over the list,
the anaphoric form with double dashes executed with <code>it</code> exposed as the list item. 
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">normal version</span>
(-map (<span style="color: #a020f0;">lambda</span> (n) (* n n)) '(1 2 3 4))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">also works for defun, of course</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">square</span> (n) (* n n))
(-map 'square '(1 2 3 4))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">anaphoric version</span>
(<span style="color: #a020f0;">--map</span> (* it it) '(1 2 3 4))
</pre>
</div></li>

<li><code>-update-at</code>: <code>(-update-at N FUNC LIST)</code> Return a list with element at Nth position in LIST replaced with `(func (nth n list))`.</li>
<li><code>-flatten</code>: <code>(-flatten L)</code>: Take a nested list L and return its contents as a single, flat list.</li>
</ul>
</div>
</div>

<div id="outline-container-org4932ffa" class="outline-3">
<h3 id="org4932ffa"><span class="section-number-3">7.2</span> s.el</h3>
<div class="outline-text-3" id="text-7-2">
<p>
<a href="https://github.com/magnars/s.el">https://github.com/magnars/s.el</a>
</p>

<p>
The string manipulation library
</p>
</div>
</div>

<div id="outline-container-org165ca6b" class="outline-3">
<h3 id="org165ca6b"><span class="section-number-3">7.3</span> cl-lib.el loop</h3>
<div class="outline-text-3" id="text-7-3">
<p>
This package ports many common lisp facilities into elisp,
most importantly, the loop facility.
So this section, at least for now, focus on <code>cl-loop</code>.
</p>
</div>

<div id="outline-container-org111c34d" class="outline-4">
<h4 id="org111c34d"><span class="section-number-4">7.3.1</span> general loop form</h4>
<div class="outline-text-4" id="text-7-3-1">
<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">cl-loop</span> clauses...)
</pre>
</div>
<p>
The clauses can be:
</p>
<ul class="org-ul">
<li>for clauses</li>
<li>TODO</li>
</ul>
</div>
</div>
<div id="outline-container-orgc181117" class="outline-4">
<h4 id="orgc181117"><span class="section-number-4">7.3.2</span> for clauses</h4>
<div class="outline-text-4" id="text-7-3-2">
<dl class="org-dl">
<dt><code>for VAR from FROM to TO by STEP</code></dt><dd><ul class="org-ul">
<li><code>FROM</code> defaults to 0. <code>STEP</code> must be positive and default to 1.</li>
<li>inclusive <code>[from,to]</code></li>
<li><code>from</code> can be <code>upfrom</code> and <code>downfrom</code>. I think it is wired to use this.</li>
<li><code>to</code> can be <code>upto</code> and <code>downto</code>. This makes more sense.</li>
<li><code>above</code> and <code>below</code> can be used, but <i>exclusive</i>. e.g. <code>for var below 10</code></li>
</ul></dd>
<dt><code>for VAR in LIST by FUNCTION</code></dt><dd><code>FUNCTION</code> is used to traverse the list, defaults to <code>cdr</code></dd>
<dt><code>for VAR on LIST by FUNCTION</code></dt><dd><code>VAR</code> is bound to the cons cell of the list instead of the element.</dd>
<dt><code>for VAR across ARRAY</code></dt><dd>iterates all elements of array</dd>
<dt><code>for VAR = EXPR1 then EXPR2</code></dt><dd>this is the most general form.
The <code>VAR</code> is bound to <code>EXPR1</code> initially, and will be set by evaluating <code>EXPR2</code> in successive iterations.
<code>EXPR2</code> can refer the old <code>VAR</code></dd>
</dl>
</div>
</div>

<div id="outline-container-org54c2240" class="outline-4">
<h4 id="org54c2240"><span class="section-number-4">7.3.3</span> iteration clauses</h4>
<div class="outline-text-4" id="text-7-3-3">
<dl class="org-dl">
<dt><code>repeat integer</code></dt><dd>repeat the loop how many times</dd>
<dt><code>while condition</code></dt><dd>stops the loop when the condition becomes nil</dd>
<dt><code>until condition</code></dt><dd></dd>

<dt><code>always condition</code></dt><dd>like while except it returns <code>nil</code>, and <code>finally</code> clauses are not executed.</dd>
<dt><code>never condition</code></dt><dd>counter part for <code>always</code></dd>
</dl>
</div>
</div>

<div id="outline-container-org6665599" class="outline-4">
<h4 id="org6665599"><span class="section-number-4">7.3.4</span> accumulation clauses</h4>
<div class="outline-text-4" id="text-7-3-4">
<dl class="org-dl">
<dt><code>collect form</code></dt><dd>collect into a list and return the list in the end</dd>
<dt><code>append form</code></dt><dd>collect the lists into a list by appending, and return it in the end</dd>
<dt><code>concat form</code></dt><dd>for string only</dd>
<dt><code>count form</code></dt><dd>count how many times form evaluates to non-nil.</dd>
<dt><code>sum form</code></dt><dd>sum all the values</dd>
<dt><code>maximize form</code></dt><dd>get the max. If the form is never executed, result is <i>undefined</i></dd>
<dt><code>minimize form</code></dt><dd></dd>
</dl>
</div>
</div>

<div id="outline-container-org30602d7" class="outline-4">
<h4 id="org30602d7"><span class="section-number-4">7.3.5</span> Other clauses</h4>
<div class="outline-text-4" id="text-7-3-5">
<dl class="org-dl">
<dt><code>with var = value</code></dt><dd>set the value one-time at the beginning of the loop.
Often used as return variable.
<b>The spaces around <code>=</code> is essential!</b>.</dd>
<dt><code>if condition clause [else clause]</code></dt><dd></dd>

<dt><code>when condition clause</code></dt><dd>same as if</dd>
<dt><code>unless condition clause</code></dt><dd>similar</dd>
<dt><code>initially [do] forms...</code></dt><dd>execute before the loop begins, but after the <code>for</code> and <code>with</code> variable bindings. <code>do</code> is optional.</dd>
<dt><code>finally [do] forms...</code></dt><dd>execute after the loop finishes</dd>
<dt><code>finally return form</code></dt><dd>finally return it &#x2026;</dd>
<dt><code>do forms...</code></dt><dd>execute as an implicit <code>progn</code> in the body</dd>
<dt><code>return form</code></dt><dd>this is often used in <code>if</code> or <code>unless</code>, because put it in top level will cause the loop always execute only once.</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-orge31643b" class="outline-3">
<h3 id="orge31643b"><span class="section-number-3">7.4</span> cl-lib other</h3>
<div class="outline-text-3" id="text-7-4">
<p>
Of course, cl-lib provides much more than just loops &#x2026;
</p>
<dl class="org-dl">
<dt><code>incf PLACE</code></dt><dd>is <code>i++</code></dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org91c74fd" class="outline-2">
<h2 id="org91c74fd"><span class="section-number-2">8</span> Debugging</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-org6858aec" class="outline-3">
<h3 id="org6858aec"><span class="section-number-3">8.1</span> lisp debugger</h3>
<div class="outline-text-3" id="text-8-1">
<p>
The simplest debugger is called <code>lisp debugger</code>.
You can turn on the <code>debug-or-error</code> flag,
but I found inserting the <code>(debug)</code> command useful.
Simply insert <code>(debug)</code> where you want program to suspend, and run it.
You will enter the debugger at that point.
In the debugger buffer, the following commands are available:
</p>
<dl class="org-dl">
<dt><code>c</code></dt><dd>continue run program</dd>
<dt><code>d</code></dt><dd>step</dd>
<dt><code>e</code></dt><dd>evaluate an prompt expression</dd>
<dt><code>R</code></dt><dd>like <code>e</code>, but also save the result in <code>*Debugger-record*</code></dd>
<dt><code>q</code></dt><dd>quit</dd>
<dt><code>v</code></dt><dd>toggle display of local variables ???</dd>
</dl>
</div>
</div>
<div id="outline-container-orgeaa1d68" class="outline-3">
<h3 id="orgeaa1d68"><span class="section-number-3">8.2</span> Edebug</h3>
<div class="outline-text-3" id="text-8-2">
<p>
For this to work, first you need to instrument the code.
You can instrument the defun by <code>C-u C-M-x</code>.
Actually this is adding a prefix before <code>eval-defun</code>,
which instrument, and then evaluate the defun.
</p>

<p>
After instrumentation, running the defun will cause the program to stop at the first <i>stop point</i> of the function.
The <i>stop points</i> are
</p>
<ul class="org-ul">
<li>before and after each subexpression that is a list</li>
<li>after each variable reference</li>
</ul>
</div>

<div id="outline-container-org4e5f675" class="outline-4">
<h4 id="org4e5f675"><span class="section-number-4">8.2.1</span> breakpoints</h4>
<div class="outline-text-4" id="text-8-2-1">
<dl class="org-dl">
<dt><code>b</code></dt><dd>set a breakpoint</dd>
<dt><code>u</code></dt><dd>unset a breakpoint</dd>
<dt><code>x CONDITION</code></dt><dd>set a conditional breakpoint</dd>
</dl>

<p>
You can also set the <i>source breakpoints</i>, by adding <code>(edebug)</code>.
</p>
</div>
</div>

<div id="outline-container-orgeeebea9" class="outline-4">
<h4 id="orgeeebea9"><span class="section-number-4">8.2.2</span> Moving of point</h4>
<div class="outline-text-4" id="text-8-2-2">
<dl class="org-dl">
<dt><code>B</code></dt><dd>move point to the next breakpoint</dd>
<dt><code>w</code></dt><dd>move point back to the current stop point</dd>
</dl>
</div>
</div>

<div id="outline-container-org3a917a3" class="outline-4">
<h4 id="org3a917a3"><span class="section-number-4">8.2.3</span> executions</h4>
<div class="outline-text-4" id="text-8-2-3">
<dl class="org-dl">
<dt><code>&lt;SPC&gt;</code></dt><dd>run to next stop point</dd>
<dt><code>g</code></dt><dd>execute until next breakpoint</dd>
<dt><code>q</code></dt><dd>exit</dd>
<dt><code>S</code></dt><dd>stop and wait for Edebug commands</dd>
<dt><code>n</code></dt><dd>evaluate a sexp and stop at stop point</dd>
<dt><code>t</code></dt><dd><i>trace</i>, pause one second at each stop point &#x2026;</dd>
<dt><code>T</code></dt><dd>rapid trace. Update the display at each stop point but don't actually pause &#x2026;</dd>
<dt><code>c</code></dt><dd>pause one second at each breakpoint</dd>
<dt><code>C</code></dt><dd>rapid continue.</dd>
<dt><code>G</code></dt><dd>run and ignore breakpoints (but you can stop it by <code>S</code>)</dd>

<dt><code>h</code></dt><dd>proceed to the stop point near the point &#x2026;</dd>
<dt><code>f</code></dt><dd>run one expression</dd>
<dt><code>o</code></dt><dd>step out the containing expression</dd>
<dt><code>i</code></dt><dd>step in</dd>
</dl>
</div>
</div>
<div id="outline-container-org07b9a04" class="outline-4">
<h4 id="org07b9a04"><span class="section-number-4">8.2.4</span> evaluation</h4>
<div class="outline-text-4" id="text-8-2-4">
<dl class="org-dl">
<dt><code>e EXP</code></dt><dd>evaluate a prompt expression</dd>
<dt><code>C-x C-e</code></dt><dd>evaluate an expression at point</dd>
</dl>
</div>
</div>

<div id="outline-container-orge6ff969" class="outline-4">
<h4 id="orge6ff969"><span class="section-number-4">8.2.5</span> other commands</h4>
<div class="outline-text-4" id="text-8-2-5">
<dl class="org-dl">
<dt><code>?</code></dt><dd>show help</dd>
<dt><code>r</code></dt><dd>redisplay the most recent sexp result</dd>
<dt><code>d</code></dt><dd>display the backtrace</dd>
</dl>
</div>
</div>
</div>
</div>



<div id="outline-container-org2a1f67f" class="outline-2">
<h2 id="org2a1f67f"><span class="section-number-2">9</span> Unit Testing</h2>
<div class="outline-text-2" id="text-9">
<p>
Use <code>ert</code> for unit testing.
</p>
</div>

<div id="outline-container-org175a563" class="outline-3">
<h3 id="org175a563"><span class="section-number-3">9.1</span> Write test</h3>
<div class="outline-text-3" id="text-9-1">
<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">ert-deftest</span> <span style="color: #0000ff;">addition-test</span>()
  <span style="color: #8b2252;">"Outline docstring."</span>
  (should (= (+ 1 2) 4)))
</pre>
</div>

<p>
The family of functions:
</p>
<ul class="org-ul">
<li><code>should</code></li>
<li><code>shoult-not</code></li>
<li><code>should-error</code></li>
</ul>

<p>
expected failure:
</p>
<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">ert-deftest</span> <span style="color: #0000ff;">addition-test</span>()
  <span style="color: #8b2252;">"Outline docstring."</span>
  <span style="color: #483d8b;">:expected-result</span> <span style="color: #483d8b;">:failed</span>
  (should (= (+ 1 2) 4)))
</pre>
</div>

<p>
skip test
</p>
<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">ert-deftest</span> <span style="color: #0000ff;">addition-test</span>()
  <span style="color: #8b2252;">"Outline docstring."</span>
  (slip-unless (<span style="color: #a020f0;">featurep</span> '<span style="color: #008b8b;">dbusbind</span>'))
  (should (= (+ 1 2) 4)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org4f17b23" class="outline-3">
<h3 id="org4f17b23"><span class="section-number-3">9.2</span> Run test</h3>
<div class="outline-text-3" id="text-9-2">
<p>
<code>M-x ert</code> will run it. The selector of test accept some more fancy staff like regular expression matching.
But in the case of scratch testing, I need to evaluate the deftest and then call <code>ert</code>.
</p>

<p>
The nice thing is it supports interactive debugging.
In the ert buffer, the following commands are available:
</p>
<dl class="org-dl">
<dt><code>r</code></dt><dd>re-run the test</dd>
<dt><code>.</code></dt><dd>jump to the source code of this test</dd>
<dt><code>b</code></dt><dd>show back-trace</dd>
<dt><code>m</code></dt><dd>show the message this test printed</dd>
<dt><code>d</code></dt><dd>re-run the test with debugger enabled</dd>
<dt>instrumentation</dt><dd>go to source code, type <code>C-u C-M-x</code>, and re-run the test. You are able to step!</dd>
</dl>

<p>
Also, select test by this:
</p>
<div class="org-src-container">
<pre class="src src-elisp">(ert-run-test (ert-get-test 'my-defined-test))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgdf696c4" class="outline-2">
<h2 id="orgdf696c4"><span class="section-number-2">10</span> Some random code snippets</h2>
<div class="outline-text-2" id="text-10">
<div class="org-src-container">
<pre class="src src-elisp">(cl-prettyprint (font-family-list)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">see all font family available on this system</span>
</pre>
</div>
</div>

<div id="outline-container-org561cf48" class="outline-4">
<h4 id="org561cf48"><span class="section-number-4">10.0.1</span> Url retrieval</h4>
<div class="outline-text-4" id="text-10-0-1">
<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">with-current-buffer</span> (url-retrieve-synchronously <span style="color: #8b2252;">"http://scholar.google.com/scholar?q=segmented symbolic analysis"</span>)
  (goto-char (point-min))
  (kill-ring-save (point-min) (point-max))
  )
(<span style="color: #a020f0;">let</span> ((framed-url (match-string 1)))
  (<span style="color: #a020f0;">with-current-buffer</span> (url-retrieve-synchronously framed-url)
    (goto-char (point-min))
    (<span style="color: #a020f0;">when</span> (re-search-forward <span style="color: #8b2252;">"&lt;frame src=\"</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">http[[:ascii:]]*?</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\""</span>)
      (match-string 1))))
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Hebi Li</p>
<p class="date">Created: 2017-11-20 Mon 10:50</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
