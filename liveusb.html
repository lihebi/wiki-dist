<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-12-07 Thu 15:13 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Create Live USB</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Hebi Li" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="assets/hebi.css" /><link rel="stylesheet" type="text/css" href="assets/test.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Create Live USB</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org06bf0aa">1. Software</a></li>
<li><a href="#org4df9d60">2. Create Linux USB</a>
<ul>
<li><a href="#orga792a28">2.1. Using dd</a></li>
<li><a href="#orge952d3b">2.2. From Mac</a></li>
</ul>
</li>
<li><a href="#org67aa073">3. Create Mac USB</a></li>
<li><a href="#orgac48dc8">4. Install Arch Linux on Macbook</a>
<ul>
<li><a href="#org48bd447">4.1. UPDATE</a></li>
<li><a href="#org0b7f2b5">4.2. Reinstall OS X</a></li>
<li><a href="#org9f82db7">4.3. Partition</a>
<ul>
<li><a href="#org35531f4">4.3.1. Install rEFInd</a></li>
<li><a href="#org01a2a82">4.3.2. Wifi</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-org06bf0aa" class="outline-2">
<h2 id="org06bf0aa"><span class="section-number-2">1</span> Software</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li>unetbootin</li>
</ul>
</div>
</div>

<div id="outline-container-org4df9d60" class="outline-2">
<h2 id="org4df9d60"><span class="section-number-2">2</span> Create Linux USB</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orga792a28" class="outline-3">
<h3 id="orga792a28"><span class="section-number-3">2.1</span> Using dd</h3>
<div class="outline-text-3" id="text-2-1">
<pre class="example">
dd bs=4M if=/path/to/archlinux.iso of=/dev/sdx &amp;&amp; sync
# restore
dd count=1 bs=512 if=/dev/zero of=/dev/sdx &amp;&amp; sync
</pre>
</div>
</div>

<div id="outline-container-orge952d3b" class="outline-3">
<h3 id="orge952d3b"><span class="section-number-3">2.2</span> From Mac</h3>
<div class="outline-text-3" id="text-2-2">
<pre class="example">
hdiutil convert -format UDRW -o ~/path/to/target.img ~/path/to/ubuntu.iso
diskutil list, insert usb, diskutil list =&gt; /dev/disk1
diskutil unmountDisk /dev/diskN
sudo dd if=/path/to/downloaded.img of=/dev/rdiskN bs=1m
diskutil eject /dev/diskN
</pre>
</div>
</div>
</div>


<div id="outline-container-org67aa073" class="outline-2">
<h2 id="org67aa073"><span class="section-number-2">3</span> Create Mac USB</h2>
<div class="outline-text-2" id="text-3">
<pre class="example">
sudo /Applications/Install\ OS\ X\ Mavericks.app/Contents/Resources/createinstallmedia \
--volume /Volumes/Untitled \
--applicationpath /Applications/InstallXXX.app \
--nointeraction
</pre>
</div>
</div>


<div id="outline-container-orgac48dc8" class="outline-2">
<h2 id="orgac48dc8"><span class="section-number-2">4</span> Install Arch Linux on Macbook</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org48bd447" class="outline-3">
<h3 id="org48bd447"><span class="section-number-3">4.1</span> UPDATE</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Stopped because I want to buy DPT-RP1 for paper reading. That thing
does not work on Linux. I'm going to use the VNC through docker
solution.
</p>
</div>
</div>
<div id="outline-container-org0b7f2b5" class="outline-3">
<h3 id="org0b7f2b5"><span class="section-number-3">4.2</span> Reinstall OS X</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Although I can download image and burn to disk, I found the internet
recovery is convenient.
</p>

<p>
When booting, hold Cmd-Option-R, then erase the disk, and reinstall
the latest Mac OS.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">key</th>
<th scope="col" class="org-left">desc</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">cmd-R</td>
<td class="org-left">reinstall the latest OS that was installed on this mac</td>
</tr>

<tr>
<td class="org-left">option-cmd-R</td>
<td class="org-left">upgrade to latest OS for this mac</td>
</tr>

<tr>
<td class="org-left">shift-option-cmd-R</td>
<td class="org-left">reinstall the OS that comes with the mac</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org9f82db7" class="outline-3">
<h3 id="org9f82db7"><span class="section-number-3">4.3</span> Partition</h3>
<div class="outline-text-3" id="text-4-3">
<p>
It is recommanded to keep archlinux with OS X, because only OS X can
install firmware updata, adjust start up sound, etc.
</p>

<p>
Partition the disk on OS X.
</p>
<ul class="org-ul">
<li>run Disk Utility</li>
<li>select the drive, click partition</li>
<li>add new partition by pressing +. The partition will be reformated in
Arch, so type does not matter.</li>
</ul>

<p>
Inside arch, run cgdisk, and delete the partition. When creating the
first partition, add 128MiB gab by typing +128M when <code>cgdisk</code> asks for
it.
</p>

<p>
For simplicity, creating one partition is fine. The swap partition can
be replaced by a swap file. Do not use LVM because
</p>
<ul class="org-ul">
<li>hard to set up right</li>
<li>need to load a module when booting, otherwise the <code>/dev/mapper/...</code>
address is not resolved.</li>
</ul>

<p>
The mac EFI partition can be directly used. Thus you only need to
create one partition for the root system. Mount the EFI partition and
chroot will be just fine. The grub bootloader in arch will add files
to the EFI partition, so next time you start your computer, arch will
be default. Pressing <code>option</code> while booting can enter macOS.
</p>
</div>

<div id="outline-container-org35531f4" class="outline-4">
<h4 id="org35531f4"><span class="section-number-4">4.3.1</span> Install rEFInd</h4>
<div class="outline-text-4" id="text-4-3-1">
<p>
rEFInd is used to give options to boot to macOS or linux.
</p>

<p>
Download and run refind-install. The SIP must be disabled first. To do that:
</p>

<p>
reboot and hold Cmd-R to enter recovery mode. Then open terminal from utility menu and type
</p>
<pre class="example">
csrutil disable
</pre>

<p>
Reboot. To enable it, follow the same process with command:
</p>
<pre class="example">
csrutil enable
</pre>
</div>
</div>

<div id="outline-container-org01a2a82" class="outline-4">
<h4 id="org01a2a82"><span class="section-number-4">4.3.2</span> Wifi</h4>
<div class="outline-text-4" id="text-4-3-2">
<p>
The wifi chipset of my 2013 late macbook pro is BCM4360. It is
supported by <code>broadcam-wl</code> or <code>broadcam-wl-dksm</code> driver. The former is
in AUR, need to recompile each time kernel is updated, thus do not use
it. The later one is from official repo, and will get updated
automatically.
</p>

<p>
Load the module by <code>modprobe wl</code>.
</p>

<p>
I'm using <code>wicd-client</code> to manage the wifi. You need the following packages:
</p>
<ul class="org-ul">
<li><code>wpa_suppliant</code></li>
<li><code>wicd</code></li>
<li><code>wicd-gtk</code></li>
</ul>

<p>
Run <code>wicd-client</code> to configure (no need root). Make sure <code>dhcpcd</code> is
NOT active, they conflict with each other.
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Hebi Li</p>
<p class="date">Created: 2017-12-07 Thu 15:13</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
