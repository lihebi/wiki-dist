<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-01-02 Tue 00:07 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Clojure</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Hebi Li" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="assets/hebi.css" /><link rel="stylesheet" type="text/css" href="assets/test.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Clojure</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org7b5030c">1. Emacs</a>
<ul>
<li><a href="#org4d92492">1.1. Eval</a></li>
<li><a href="#orgf21eac9">1.2. Navigation</a></li>
<li><a href="#org65591cb">1.3. Doc</a></li>
<li><a href="#org9921a59">1.4. Tests</a></li>
</ul>
</li>
<li><a href="#org32d543e">2. Lein</a></li>
<li><a href="#org1e7bd27">3. A first try</a>
<ul>
<li><a href="#org3fb37f6">3.1. Setup</a></li>
<li><a href="#org75d60d7">3.2. Type</a></li>
<li><a href="#orgbfe5b10">3.3. Function</a></li>
<li><a href="#org2b7829c">3.4. Macro</a></li>
<li><a href="#org8dc0c99">3.5. State</a>
<ul>
<li><a href="#orgef42888">3.5.1. delay</a></li>
<li><a href="#org9e9e5d2">3.5.2. Future</a>
<ul>
<li><a href="#orgbefc269">3.5.2.1. Atom</a></li>
<li><a href="#org75123b0">3.5.2.2. Ref</a></li>
</ul>
</li>
<li><a href="#org8630497">3.5.3. Promise</a></li>
</ul>
</li>
<li><a href="#orgf7ceb97">3.6. <span class="todo TODO">TODO</span> Logistics</a></li>
<li><a href="#org8459329">3.7. <span class="todo TODO">TODO</span> Modeling</a></li>
<li><a href="#orgc4d2dc6">3.8. <span class="todo TODO">TODO</span> Debugging</a></li>
</ul>
</li>
<li><a href="#org4abf402">4. clojure.core</a>
<ul>
<li><a href="#orgeb57154">4.1. Namespace</a></li>
</ul>
</li>
<li><a href="#orge0e47aa">5. Type</a>
<ul>
<li><a href="#org7614a2b">5.1. Number</a>
<ul>
<li><a href="#org7e7e751">5.1.1. Arithmetic</a></li>
<li><a href="#org1d9a43f">5.1.2. Compare</a></li>
<li><a href="#org6b5df2e">5.1.3. Bitwise</a></li>
<li><a href="#org02f24ac">5.1.4. Cast</a></li>
<li><a href="#org757ec2d">5.1.5. Predicate</a></li>
<li><a href="#org80a7909">5.1.6. Random</a></li>
</ul>
</li>
<li><a href="#org9ebc27b">5.2. symbols &amp; keywords</a></li>
<li><a href="#org3287d57">5.3. String</a>
<ul>
<li><a href="#org8c6fb06">5.3.1. Use</a></li>
<li><a href="#orgb3fc35d">5.3.2. Regex</a></li>
<li><a href="#orgc250f1f">5.3.3. Letter</a></li>
<li><a href="#org30971a8">5.3.4. trim</a></li>
<li><a href="#orgff0a398">5.3.5. Predicate</a></li>
<li><a href="#org615c733">5.3.6. characters</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org94f4dcc">6. Collections</a>
<ul>
<li><a href="#orge23ecd3">6.1. Collection</a>
<ul>
<li><a href="#orgf2c702e">6.1.1. Generic</a></li>
<li><a href="#orgc4bf7e0">6.1.2. ops</a></li>
<li><a href="#orgcd6ba4e">6.1.3. Predicates</a></li>
<li><a href="#org90fa8d8">6.1.4. Capabilities</a></li>
</ul>
</li>
<li><a href="#org2ff70e6">6.2. List</a></li>
<li><a href="#orge550d99">6.3. Vector</a>
<ul>
<li><a href="#org55fedf3">6.3.1. Create</a></li>
<li><a href="#org5f2fcc8">6.3.2. Examine</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org9996cab">7. Reference</a></li>
</ul>
</div>
</div>

<div id="outline-container-org7b5030c" class="outline-2">
<h2 id="org7b5030c"><span class="section-number-2">1</span> Emacs</h2>
<div class="outline-text-2" id="text-1">
<p>
It is called cider
</p>
<ul class="org-ul">
<li><a href="https://github.com/clojure-emacs/cider">https://github.com/clojure-emacs/cider</a></li>
<li><a href="https://cider.readthedocs.io/en/latest/">https://cider.readthedocs.io/en/latest/</a></li>
</ul>

<p>
First, `lein new hello-world` to create a hello-world project.
</p>

<p>
Navigate emacs to one of the files or the directory inside the project
and call `cider-jack-in`.
</p>
</div>

<div id="outline-container-org4d92492" class="outline-3">
<h3 id="org4d92492"><span class="section-number-3">1.1</span> Eval</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>cider-eval-last-sexp (C-x C-e)</li>
<li>cider-eval-defun-at-point (C-M-x)</li>
<li>cider-interrupt: interrupt pending evaluation</li>
<li>cider-macroexpand-1 (C-c C-m)</li>
<li>cider-load-buffer</li>
<li>cider-refresh: reload all modified files</li>
<li>cider-inspect (C-c M-i)</li>
</ul>
</div>
</div>

<div id="outline-container-orgf21eac9" class="outline-3">
<h3 id="orgf21eac9"><span class="section-number-3">1.2</span> Navigation</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>cider-switch-to-repl-buffer (C-c C-z)</li>
<li>cider-quit</li>
</ul>
</div>
</div>

<div id="outline-container-org65591cb" class="outline-3">
<h3 id="org65591cb"><span class="section-number-3">1.3</span> Doc</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>cider-doc (C-c C-d C-d)</li>
<li>cider-javadoc (C-c C-d C-j): display in browser</li>
</ul>
</div>
</div>

<div id="outline-container-org9921a59" class="outline-3">
<h3 id="org9921a59"><span class="section-number-3">1.4</span> Tests</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>cider-test-run-test: run test at point</li>
<li>cider-test-rerun-test: rerun the last test</li>
<li>cider-test-run-project-tests</li>
<li>cider-test-rerun-failed-tests</li>
<li>cider-test-show-report</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org32d543e" class="outline-2">
<h2 id="org32d543e"><span class="section-number-2">2</span> Lein</h2>
<div class="outline-text-2" id="text-2">
<pre class="example">
lein new hello-world
cd hello-world
lein deps # install deps
lein repl # start repl
</pre>
</div>
</div>

<div id="outline-container-org1e7bd27" class="outline-2">
<h2 id="org1e7bd27"><span class="section-number-2">3</span> A first try</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org3fb37f6" class="outline-3">
<h3 id="org3fb37f6"><span class="section-number-3">3.1</span> Setup</h3>
<div class="outline-text-3" id="text-3-1">
<p>
First, install clojure and lein2.
</p>

<p>
To start a new project:
</p>
<pre class="example">
lein new myproj
cd myproj
lein repl
</pre>


<p>
This will install dependencies and enter repl.
</p>
</div>
</div>


<div id="outline-container-org75d60d7" class="outline-3">
<h3 id="org75d60d7"><span class="section-number-3">3.2</span> Type</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Since clojure sits on top of JVM, the type seems to be the same, and
you can get the type of something by the function <code>type</code>.
</p>

<pre class="example">
user=&gt; (type 3)
;; java.lang.Long
user=&gt; (type :cat)
clojure.lang.Keyword
</pre>

<p>
A list of types
</p>
<dl class="org-dl">
<dt>java.lang.Long</dt><dd>(type 3)</dd>
<dt>clojure.lang.BigInt</dt><dd>(type 5N)</dd>
<dt>java.lang.Integer</dt><dd>(type (int 0))</dd>
<dt>java.lang.Short</dt><dd>(type (short 0))</dd>
<dt>java.lang.Byte</dt><dd>(type (byte 0))</dd>
<dt>java.lang.Double</dt><dd>(type 1.23)</dd>
<dt>java.lang.Float</dt><dd>(type (float 1.23))</dd>
<dt>java.lang.String</dt><dd>(type "cat")</dd>
<dt>clojure.lang.Symbol</dt><dd>(class 'str)</dd>
<dt>clojure.lang.Keyword</dt><dd>(type :cat)</dd>
<dt>clojure.lang.PersistentList</dt><dd>(type '(1 2 3))</dd>
<dt>clojure.lang.PersistentVector</dt><dd>(type [1 2 3])</dd>
<dt>clojure.lang.PersistentHashSet</dt><dd>#{:a :b :c}</dd>
<dt>clojure.lang.PersistentArrayMap</dt><dd>{:name "mittens" :weight 9 :color "black"}</dd>
</dl>
</div>
</div>

<div id="outline-container-orgbfe5b10" class="outline-3">
<h3 id="orgbfe5b10"><span class="section-number-3">3.3</span> Function</h3>
<div class="outline-text-3" id="text-3-3">
<dl class="org-dl">
<dt>let</dt><dd></dd>

<dt>fn</dt><dd>lambda function</dd>
<dt>def</dt><dd>symbol</dd>
<dt>defn</dt><dd>define a named function</dd>
</dl>
</div>
</div>

<div id="outline-container-org2b7829c" class="outline-3">
<h3 id="org2b7829c"><span class="section-number-3">3.4</span> Macro</h3>
<div class="outline-text-3" id="text-3-4">
<dl class="org-dl">
<dt>defmacro</dt><dd></dd>
</dl>
</div>
</div>

<div id="outline-container-org8dc0c99" class="outline-3">
<h3 id="org8dc0c99"><span class="section-number-3">3.5</span> State</h3>
<div class="outline-text-3" id="text-3-5">
</div>
<div id="outline-container-orgef42888" class="outline-4">
<h4 id="orgef42888"><span class="section-number-4">3.5.1</span> delay</h4>
<div class="outline-text-4" id="text-3-5-1">
<p>
Basically this is an abstraction of function: define a function will
not evaluate function body. So delay works similar: the call to delay
returns an Delay Object, which can be called on by <code>deref</code> to evaluate
the body.
</p>

<div class="org-src-container">
<pre class="src src-clojure">(def later (fn [] (prn "Adding") (+ 1 2)))
(later) ;; =&gt; print output

(def later (delay (prn "Adding") (+ 1 2)))
(deref later) ;; =&gt; print output
</pre>
</div>

<p>
The difference between a delay and a function:
</p>
<ul class="org-ul">
<li>function evaluate every time it is called</li>
<li>delays only evaluate their expressions once. They remember their
value, after the first evaluation, and return it for every
successive deref.</li>
</ul>

<p>
The delay opeartor: <code>@later</code> is equivalent to <code>(deref later)</code>.
</p>
</div>
</div>
<div id="outline-container-org9e9e5d2" class="outline-4">
<h4 id="org9e9e5d2"><span class="section-number-4">3.5.2</span> Future</h4>
<div class="outline-text-4" id="text-3-5-2">
<p>
This is for parallel.
</p>

<blockquote>
<p>
I don’t need the result of evaluating these expressions yet, but I’d
like it later. Could you start working on it in the meantime?
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-clojure">(def x (future (prn "hi") (+ 1 2)))
(deref x) ;; =&gt; 3
</pre>
</div>

<p>
The body of future is executed in a <b>new thread</b> in parallel! Deref it
will get the value of the <b>last</b> expression.  Like delays, the
expressions are only evaluated once.
</p>
</div>

<div id="outline-container-orgbefc269" class="outline-5">
<h5 id="orgbefc269"><span class="section-number-5">3.5.2.1</span> Atom</h5>
<div class="outline-text-5" id="text-3-5-2-1">
<p>
The parallel program brings thread-safe problem: modify something at
the same time in different threads. Clojure has a <code>atom</code> function to
protect a data and ensure its thread-safety.
</p>

<p>
Use <code>reset!</code> to set value of atom, and use <code>swap!</code> to update.
</p>

<div class="org-src-container">
<pre class="src src-clojure">(def xs #{})
(dotimes [i 10] (future (def xs (conj xs i))))
user=&gt; xs ;; =&gt; #{1 4 5 7}

(def xs (atom #{}))
(dotimes [i 10] (future (swap! xs conj i)))
user=&gt; @xs ;; =&gt; #{0 1 2 3 4 5 6 7 8 9}
</pre>
</div>
</div>
</div>

<div id="outline-container-org75123b0" class="outline-5">
<h5 id="org75123b0"><span class="section-number-5">3.5.2.2</span> Ref</h5>
<div class="outline-text-5" id="text-3-5-2-2">
<p>
Atom is linearizable, but not serializable: it does not guarantee
orders. Ref is serializable.
</p>

<p>
Use <code>ref-set</code> to set value of a ref, and use <code>alter</code> to update. They
must be in a <code>dosync</code> block, and the block order is guaranteed.
</p>

<div class="org-src-container">
<pre class="src src-clojure">user=&gt; (def x (ref 0))
user=&gt; (def y (ref 0))
user=&gt; (dosync
         (ref-set x 1)
         (ref-set y 2))
2
user=&gt; [@x @y]
[1 2]

user=&gt; (def x (ref 1))
user=&gt; (def y (ref 2))
user=&gt; (dosync
         (alter x + 2)
         (alter y inc))
3
user=&gt; [@x @y]
[3 3]
</pre>
</div>

<p>
If some of the refs do not need order, you can boost the program by
release that, using <code>commute</code>:
</p>

<div class="org-src-container">
<pre class="src src-clojure">user=&gt; (dosync
         (commute x + 2)
         (commute y inc))
</pre>
</div>

<p>
Finally, you can use <code>ensure</code> to update one ref using another,
guaranteeing order.
</p>
<div class="org-src-container">
<pre class="src src-clojure">user=&gt; (dosync
         (alter x + (ensure y)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org8630497" class="outline-4">
<h4 id="org8630497"><span class="section-number-4">3.5.3</span> Promise</h4>
<div class="outline-text-4" id="text-3-5-3">
<blockquote>
<p>
Delays defer evaluation, and futures parallelize it. What if we wanted
to defer something we dont even have yet? To hand someone an empty box
and, later, before they open it, sneak in and replacing its contents
with an actual gift?
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-clojure">(def box (promise))
(deref box) ;; empty
(deliver box :live-scorpiojns!)
(deref box) ;; =&gt; live-scorpiojns!
(deliver box :puppy) ;; =&gt; nil
(deref box) ;; =&gt; live-scorpiojns!
</pre>
</div>

<p>
Some highlights:
</p>
<ul class="org-ul">
<li>box contains nothing initially</li>
<li>can be delivered</li>
<li>cannot be re-delivered</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-orgf7ceb97" class="outline-3">
<h3 id="orgf7ceb97"><span class="section-number-3">3.6</span> <span class="todo TODO">TODO</span> Logistics</h3>
<div class="outline-text-3" id="text-3-6">
<p>
<a href="https://aphyr.com/posts/311-clojure-from-the-ground-up-logistics">https://aphyr.com/posts/311-clojure-from-the-ground-up-logistics</a>
</p>
</div>
</div>

<div id="outline-container-org8459329" class="outline-3">
<h3 id="org8459329"><span class="section-number-3">3.7</span> <span class="todo TODO">TODO</span> Modeling</h3>
<div class="outline-text-3" id="text-3-7">
<p>
<a href="https://aphyr.com/posts/312-clojure-from-the-ground-up-modeling">https://aphyr.com/posts/312-clojure-from-the-ground-up-modeling</a>
</p>
</div>
</div>

<div id="outline-container-orgc4d2dc6" class="outline-3">
<h3 id="orgc4d2dc6"><span class="section-number-3">3.8</span> <span class="todo TODO">TODO</span> Debugging</h3>
<div class="outline-text-3" id="text-3-8">
<p>
<a href="https://aphyr.com/posts/319-clojure-from-the-ground-up-debugging">https://aphyr.com/posts/319-clojure-from-the-ground-up-debugging</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org4abf402" class="outline-2">
<h2 id="org4abf402"><span class="section-number-2">4</span> clojure.core</h2>
<div class="outline-text-2" id="text-4">
<ul class="org-ul">
<li><code>*in*</code></li>
<li><code>*out*</code></li>
<li><code>*err*</code></li>

<li>assert</li>
</ul>
</div>


<div id="outline-container-orgeb57154" class="outline-3">
<h3 id="orgeb57154"><span class="section-number-3">4.1</span> Namespace</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Namespaces are maps that map name to var. Namespace is seperated by
dot, similar to java. The recommended format: <code>org.lib.funcgroup</code>.
</p>

<ul class="org-ul">
<li><code>clojure.core/ns</code>: [name docstring? attr-map? references*]
<ul class="org-ul">
<li>set <code>*ns*</code> to name</li>
<li>references are same as calling them, except arguments are not quoted
<ul class="org-ul">
<li>(:refer-clojure &#x2026;)</li>
<li>(:require &#x2026;)</li>
<li>(:use &#x2026;)</li>
<li>(:import &#x2026;)</li>
<li>(:load &#x2026;)</li>
<li>(:gen-class)</li>
</ul></li>
</ul></li>

<li><code>require [&amp; args]</code>: The scope will be available, the functions under
them can be called using the scope.
<ul class="org-ul">
<li>load libs, skip already loaded.</li>
<li>do not usually use directly, use in <code>ns</code> instead</li>
<li>args can be a single symbol, or with options. It recognizes options
<ul class="org-ul">
<li><code>:as sym</code>: as a symbol. e.g. <code>(require [clojure.walk :as walk])</code></li>
<li><code>:refer sym-list</code>: the list of symbols inside the lib can be
called without the scope. The list can be <code>:all</code></li>
</ul></li>
</ul></li>
<li><code>refer [ns-sym &amp;filters]</code>: refer to all public vars of ns into
current namespace. Filters:
<ul class="org-ul">
<li>:exclude list-of-symbols</li>
<li>:only list-of-symbols</li>
<li>:rename map-of-fromsymbol-tosymbol</li>
</ul></li>
<li><code>refer-clojure [&amp; filters]</code>: same as (refer 'clojure-core
&lt;filters&gt;). clojure-core is refered by default, so this is typically
used with exclude filter.</li>
<li><code>use [&amp; args]</code>: do not use after clojure 1.4. Use <code>require</code> with
<code>:refer</code> instead
<ol class="org-ol">
<li>require</li>
<li>refer the lib's namespace</li>
</ol></li>
<li><code>import [&amp; import-symbols-or-lists]</code>: as import a java classes and
make them usable in their short name in clojure
<ul class="org-ul">
<li>since we have the rest sign <code>&amp;</code>, the arguments are not inside a
list, but as multiple arguments for import</li>
<li>as the argument name indicates, it can be symbol or list
<ul class="org-ul">
<li>symbol: is the full java class, e.g. <code>java.util.Date</code></li>
<li>list: to save some typing, if importing multiple classes from
same namespace: <code>[java.util.concurrent Executors TimeUnit]</code></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orge0e47aa" class="outline-2">
<h2 id="orge0e47aa"><span class="section-number-2">5</span> Type</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org7614a2b" class="outline-3">
<h3 id="org7614a2b"><span class="section-number-3">5.1</span> Number</h3>
<div class="outline-text-3" id="text-5-1">
</div>
<div id="outline-container-org7e7e751" class="outline-4">
<h4 id="org7e7e751"><span class="section-number-4">5.1.1</span> Arithmetic</h4>
<div class="outline-text-4" id="text-5-1-1">
<ul class="org-ul">
<li>+-*/</li>
<li>quot</li>
<li>rem</li>
<li>mod</li>
<li>inc</li>
<li>dec</li>
<li>max</li>
<li>min</li>
<li>with-precision</li>
</ul>
</div>
</div>

<div id="outline-container-org1d9a43f" class="outline-4">
<h4 id="org1d9a43f"><span class="section-number-4">5.1.2</span> Compare</h4>
<div class="outline-text-4" id="text-5-1-2">
<ul class="org-ul">
<li>=</li>
<li>==</li>
<li>not=</li>
<li>&lt;, &lt;=, &gt;, &gt;=</li>
</ul>
</div>
</div>

<div id="outline-container-org6b5df2e" class="outline-4">
<h4 id="org6b5df2e"><span class="section-number-4">5.1.3</span> Bitwise</h4>
<div class="outline-text-4" id="text-5-1-3">
<ul class="org-ul">
<li>bit-and</li>
<li>bit-or</li>
<li>bit-xor</li>
<li>bit-flip</li>
<li>bit-not</li>
<li>bit-clear</li>
<li>bit-set</li>
<li>bit-shift-right</li>
<li>bit-shift-left</li>
<li>bit-test</li>
</ul>
</div>
</div>

<div id="outline-container-org02f24ac" class="outline-4">
<h4 id="org02f24ac"><span class="section-number-4">5.1.4</span> Cast</h4>
<div class="outline-text-4" id="text-5-1-4">
<ul class="org-ul">
<li>byte</li>
<li>short</li>
<li>int</li>
<li>long</li>
<li>float</li>
<li>double</li>
<li>bigint</li>
<li>bigdec</li>
<li>num</li>
<li>rationalize</li>
</ul>
</div>
</div>
<div id="outline-container-org757ec2d" class="outline-4">
<h4 id="org757ec2d"><span class="section-number-4">5.1.5</span> Predicate</h4>
<div class="outline-text-4" id="text-5-1-5">
<ul class="org-ul">
<li>nil?</li>
<li>identical?</li>
<li>zero?</li>
<li>pos?</li>
<li>neg?</li>
<li>even?</li>
<li>odd?</li>
</ul>

<p>
Other
</p>
<ul class="org-ul">
<li>number?</li>
<li>rational?</li>
<li>integer?</li>
<li>ratio?</li>
<li>decimal?</li>
<li>float?</li>
</ul>
</div>
</div>
<div id="outline-container-org80a7909" class="outline-4">
<h4 id="org80a7909"><span class="section-number-4">5.1.6</span> Random</h4>
<div class="outline-text-4" id="text-5-1-6">
<ul class="org-ul">
<li>rand</li>
<li>rand-int</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-org9ebc27b" class="outline-3">
<h3 id="org9ebc27b"><span class="section-number-3">5.2</span> symbols &amp; keywords</h3>
<div class="outline-text-3" id="text-5-2">
<p>
literals for keywords: <code>:kw</code>, <code>:my.ns/kw</code>, <code>::in-cur-ns</code>
</p>
</div>
</div>


<div id="outline-container-org3287d57" class="outline-3">
<h3 id="org3287d57"><span class="section-number-3">5.3</span> String</h3>
<div class="outline-text-3" id="text-5-3">
</div>
<div id="outline-container-org8c6fb06" class="outline-4">
<h4 id="org8c6fb06"><span class="section-number-4">5.3.1</span> Use</h4>
<div class="outline-text-4" id="text-5-3-1">
<ul class="org-ul">
<li>count</li>
<li>get</li>
<li>subs</li>

<li>join</li>
<li>escape</li>
<li>split</li>
<li>split-lines</li>
<li>replace</li>
<li>replace-first</li>
<li>reverse</li>
<li>index-of</li>
<li>last-index-of</li>
</ul>
</div>
</div>
<div id="outline-container-orgb3fc35d" class="outline-4">
<h4 id="orgb3fc35d"><span class="section-number-4">5.3.2</span> Regex</h4>
<div class="outline-text-4" id="text-5-3-2">
<ul class="org-ul">
<li>#"pattern"</li>
<li>re-find</li>
<li>re-seq</li>
<li>re-matches</li>
<li>re-pattern</li>
<li>re-matcher</li>
<li>re-groups</li>
<li>replace</li>
<li>replace-first</li>
<li>re-quote-replacement</li>
</ul>
</div>
</div>
<div id="outline-container-orgc250f1f" class="outline-4">
<h4 id="orgc250f1f"><span class="section-number-4">5.3.3</span> Letter</h4>
<div class="outline-text-4" id="text-5-3-3">
<ul class="org-ul">
<li>capitalize</li>
<li>lower-case</li>
<li>upper-case</li>
</ul>
</div>
</div>
<div id="outline-container-org30971a8" class="outline-4">
<h4 id="org30971a8"><span class="section-number-4">5.3.4</span> trim</h4>
<div class="outline-text-4" id="text-5-3-4">
<ul class="org-ul">
<li>trim</li>
<li>trim-newline</li>
<li>triml</li>
<li>trimr</li>
</ul>
</div>
</div>
<div id="outline-container-orgff0a398" class="outline-4">
<h4 id="orgff0a398"><span class="section-number-4">5.3.5</span> Predicate</h4>
<div class="outline-text-4" id="text-5-3-5">
<ul class="org-ul">
<li>string?</li>
<li>blank?</li>
<li>starts-with?</li>
<li>ends-with?</li>
<li>includes?</li>
</ul>
</div>
</div>
<div id="outline-container-org615c733" class="outline-4">
<h4 id="org615c733"><span class="section-number-4">5.3.6</span> characters</h4>
<div class="outline-text-4" id="text-5-3-6">
<ul class="org-ul">
<li>literals: <code>\a</code> <code>\newline</code></li>
<li>char</li>
<li>char?</li>
<li>char-name-string</li>
<li>char-escape-string</li>
</ul>
</div>
</div>
</div>
</div>


<div id="outline-container-org94f4dcc" class="outline-2">
<h2 id="org94f4dcc"><span class="section-number-2">6</span> Collections</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-orge23ecd3" class="outline-3">
<h3 id="orge23ecd3"><span class="section-number-3">6.1</span> Collection</h3>
<div class="outline-text-3" id="text-6-1">
</div>
<div id="outline-container-orgf2c702e" class="outline-4">
<h4 id="orgf2c702e"><span class="section-number-4">6.1.1</span> Generic</h4>
<div class="outline-text-4" id="text-6-1-1">
<ul class="org-ul">
<li>count</li>
<li>empty</li>
<li>not-empty</li>
</ul>
</div>
</div>
<div id="outline-container-orgc4bf7e0" class="outline-4">
<h4 id="orgc4bf7e0"><span class="section-number-4">6.1.2</span> ops</h4>
<div class="outline-text-4" id="text-6-1-2">
<ul class="org-ul">
<li>into</li>
<li>conj</li>
<li>walk</li>
<li>prewalk</li>
<li>prewalk-demo</li>
<li>prewalk-replace</li>
</ul>
</div>
</div>
<div id="outline-container-orgcd6ba4e" class="outline-4">
<h4 id="orgcd6ba4e"><span class="section-number-4">6.1.3</span> Predicates</h4>
<div class="outline-text-4" id="text-6-1-3">
<ul class="org-ul">
<li>distince?</li>
<li>empty?</li>
<li>every?</li>
<li>not-every?</li>
<li>some</li>
<li>not-any?</li>
</ul>
</div>
</div>
<div id="outline-container-org90fa8d8" class="outline-4">
<h4 id="org90fa8d8"><span class="section-number-4">6.1.4</span> Capabilities</h4>
<div class="outline-text-4" id="text-6-1-4">
<ul class="org-ul">
<li>sequential?</li>
<li>associative?</li>
<li>sorted?</li>
<li>counted?</li>
<li>reversible?</li>
<li>coll?</li>
<li>list?</li>
<li>vector?</li>
<li>set?</li>
<li>map?</li>
<li>seq?</li>
<li>record?</li>
<li>map-entry?</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org2ff70e6" class="outline-3">
<h3 id="org2ff70e6"><span class="section-number-3">6.2</span> List</h3>
<div class="outline-text-3" id="text-6-2">
<ul class="org-ul">
<li>list</li>
<li>list*</li>
<li>first</li>
<li>nth</li>
<li>peek</li>
<li>.indexOf</li>
<li>.lastIndexOf</li>
<li>cons</li>
<li>conj</li>
<li>rest</li>
<li>pop</li>
</ul>
</div>
</div>

<div id="outline-container-orge550d99" class="outline-3">
<h3 id="orge550d99"><span class="section-number-3">6.3</span> Vector</h3>
<div class="outline-text-3" id="text-6-3">
</div>
<div id="outline-container-org55fedf3" class="outline-4">
<h4 id="org55fedf3"><span class="section-number-4">6.3.1</span> Create</h4>
<div class="outline-text-4" id="text-6-3-1">
<ul class="org-ul">
<li><code>[ ]</code></li>
<li>vector</li>
<li>vec</li>
<li>vector-of</li>
<li>mapv</li>
<li>filterv</li>
<li>vector-of</li>
</ul>
</div>
</div>
<div id="outline-container-org5f2fcc8" class="outline-4">
<h4 id="org5f2fcc8"><span class="section-number-4">6.3.2</span> Examine</h4>
<div class="outline-text-4" id="text-6-3-2">
<ul class="org-ul">
<li>nth</li>
<li>get</li>
<li>peek</li>
</ul>
</div>
</div>
</div>
</div>



<div id="outline-container-org9996cab" class="outline-2">
<h2 id="org9996cab"><span class="section-number-2">7</span> Reference</h2>
<div class="outline-text-2" id="text-7">
<ul class="org-ul">
<li><a href="https://clojure.github.io/">https://clojure.github.io/</a> is the API reference, in alphabet order</li>
</ul>

<p>
Some interesting projects:
</p>
<ul class="org-ul">
<li><a href="supercollider.html">SuperCollider</a> is a server and a language for music synthesizing.</li>
<li><a href="overtone.html">Overtone</a> offers a <i>clojure</i> wrapper and emacs environment for the SuperCollider backend.</li>
<li><a href="https://github.com/ring-clojure/ring">https://github.com/ring-clojure/ring</a></li>
<li><a href="http://liquidz.github.io/">http://liquidz.github.io/</a></li>
<li><a href="https://github.com/liquidz/misaki">https://github.com/liquidz/misaki</a></li>
<li><a href="http://nakkaya.com/">http://nakkaya.com/</a></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Hebi Li</p>
<p class="date">Created: 2018-01-02 Tue 00:07</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
